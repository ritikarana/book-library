import React, { Component } from 'react';
import { connect } from 'react-redux';
import Book from './Book';
import store from "../store/index";
import EditComponent from './EditComponent';
window.store = store;
class AllBook extends Component {

  componentDidMount() {

    store.getState()
    return false;
    this.setState({
      books: store.getState()["books"],

    });

    store.subscribe(() => {
      this.setState({
        books: store.getState()["books"],
        
      });
    });
  }
  handleChange = event => {
    console.log("Search----------" + event.target.value);

    var updatedList = this.state.books;
    updatedList = updatedList.filter(function(book) {
      return (
        book.title.toLowerCase().search(event.target.value.toLowerCase()) !== -1
      );
    });

    this.setState({ books: updatedList });
  };

render() {
return (
<div>
  <h1 className="post_heading">All Books</h1>
  <div class="searchbar"><input type="text" className="search-bar" onChange={this.handleChange}  placeholder="Search" /></div>
{this.state.books.length == 0 ? ( <div><h4>No record found.Please check it again</h4></div> ) : (

  <div>

  {this.props.books.map((book) => (
  <div key={book.id}>
    {book.editing ?
    <EditComponent book={book} key={book.id} />
    : <Book book={book}
    key={book.id} />}
  </div>
)
)} </div>
    
)}
</div>
);
}
}

const mapStateToProps = (state) => {
return {
books: state
}
}
export default connect(mapStateToProps)(AllBook);